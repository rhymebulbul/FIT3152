clus_cor <- cor(subset(numeric_clus, select = -coded_country), use = "complete.obs")
colnames(similar)[colnames(similar) == "country"] <- "coded_country"
intersect <- merge(cvbase, similar, by = "coded_country", all = FALSE)
intersect <- intersect[, -ncol(intersect)]
clus <- filter(intersect, coded_country != "Croatia")
# numeric_clus <- sapply(clus, is.numeric)
clus_cor <- cor(subset(clus, select = -coded_country), use = "complete.obs")
colnames(similar)[colnames(similar) == "country"] <- "coded_country"
intersect <- merge(cvbase, similar, by = "coded_country", all = FALSE)
intersect <- intersect[, -ncol(intersect)]
clus <- filter(intersect, coded_country != "United States of America")
clus_cor <- cor(subset(clus, select = -coded_country), use = "complete.obs")
colnames(similar)[colnames(similar) == "country"] <- "coded_country"
intersect <- merge(cvbase, similar, by = "coded_country", all = FALSE)
intersect <- intersect[, -ncol(intersect)]
clus <- filter(intersect, coded_country != "United States of America")
clus_cor <- cor(subset(clus, select = -coded_country), use = "complete.obs")
rm(list = ls())
set.seed(32685467)
cvbase <- read.csv("PsyCoronaBaselineExtract.csv")
cvbase <- cvbase[sample(nrow(cvbase), 40000), ]
attach(cvbase)
library(ggplot2)
library(dplyr)
library(tidyr)
dim(cvbase)
as.data.frame(sapply(cvbase, class))  # get data types of each column
summary(cvbase, na.rm = TRUE)
sort(unique(cvbase$coded_country))  # get all country names
table(cvbase$coded_country)         # get number of entries for each country
# get maximum and minimum number of entries, and their corresponding countries
max(table(cvbase$coded_country))
which(table(cvbase$coded_country) == max(table(cvbase$coded_country)))
max(table(cvbase$coded_country))
which(table(cvbase$coded_country) == min(table(cvbase$coded_country)))
for (i in 21:30) {
cvbase[, i][is.na(cvbase[, i])] <- 0
}
usa <- cvbase[coded_country == "United States of America", ]
rem <- anti_join(cvbase, usa)
means <- colMeans(usa[, !names(usa) %in% c("coded_country")], na.rm = TRUE)
usa_means <- data.frame(mean = means)
means <- colMeans(rem[, !names(rem) %in% c("coded_country")], na.rm = TRUE)
rem_means <- data.frame(mean = means)
usa_plot <- ggplot(usa_means) +
geom_bar(mapping = aes(x = rownames(usa_means), y = mean), stat = "identity",
fill = "blue") +
coord_flip() +
labs(x = "Survey questions", y = "Mean value of responses",
title = "Mean values of responses for each survey question in the United States")
rem_plot <- ggplot(rem_means) +
geom_bar(mapping = aes(x = rownames(rem_means), y = mean), stat = "identity",
fill = "red") +
coord_flip() +
labs(x = "Survey questions", y = "Mean value of responses",
title = "Mean values of responses for each survey question in the rest of the world")
usa_plot
rem_plot
usa_cor <- cor(subset(usa, select = -coded_country), use = "complete.obs")
# reshapes matrix to long format for plotting
usa_melted <- reshape2::melt(usa_cor)
usa_cor_plot <- ggplot(data = usa_melted) +
geom_tile(mapping = aes(x = Var1, y = Var2, fill = value)) +
scale_fill_gradient2(low = "#6b74ff", mid = "white", high = "#e46c6c", midpoint = 0) +
labs(title = "Correlation between predictors for the United States", x = "", y = "",
fill = "correlation") +
theme(axis.text.x = element_text(angle = 90))
usa_cor_plot
prds <- NULL
mdl <- NULL
model_eval <- function(model) {
rsqr <- summary(model)$r.squared
a_rsqr <- summary(model)$adj.r.squared
sig <- which(summary(model)$coefficients[-1, 4] < 0.001) + 1
preds <- rownames(summary(model)$coefficients[sig, , drop = FALSE])
coefs <- summary(model)$coefficients[sig, 1]
return(list(rsqr, a_rsqr, preds, coefs))
}
fitted_usa1 <- lm(c19ProSo01 ~ .,
data = subset(usa, select = -c(coded_country, c19ProSo02, c19ProSo03, c19ProSo04)))
fitted_usa2 <- lm(c19ProSo02 ~ .,
data = subset(usa, select = -c(coded_country, c19ProSo01, c19ProSo03, c19ProSo04)))
fitted_usa3 <- lm(c19ProSo03 ~ .,
data = subset(usa, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo04)))
fitted_usa4 <- lm(c19ProSo04 ~ .,
data = subset(usa, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo03)))
cat("Summary of models for predicting pro-social attitudes in the United States\n\n")
counter <- 1
for (model in list(fitted_usa1, fitted_usa2, fitted_usa3, fitted_usa4)) {
cat("C19ProSo0", counter, "\n", sep = "")
res <- model_eval(model)
cat("R-squared value:", res[[1]], "\n")
cat("Adjusted R-squared value:", res[[2]], "\n")
cat("Significant predictors with p-value < 0.001:\n")
cat(res[[3]], "\n")
cat("Coefficients of predictors:\n")
cat(res[[4]], "\n")
cat("\n")
for (pred in res[[3]]) {
mdl <- c(mdl, paste0("USA C19ProSo0", counter))
}
prds <- c(prds, res[[3]])
counter <- counter + 1
}
rem_cor <- cor(subset(rem, select = -coded_country), use = "complete.obs")
rem_melted <- reshape2::melt(rem_cor)
rem_cor_plot <- ggplot(data = rem_melted) +
geom_tile(mapping = aes(x = Var1, y = Var2, fill = value)) +
scale_fill_gradient2(low = "#6b74ff", mid = "white", high = "#e46c6c", midpoint = 0) +
labs(title = "Correlation between predictors for the rest of the world", x = "", y = "",
fill = "correlation") +
theme(axis.text.x = element_text(angle = 90))
rem_cor_plot
fitted_rem1 <- lm(c19ProSo01 ~ .,
data = subset(rem, select = -c(coded_country, c19ProSo02, c19ProSo03, c19ProSo04)))
fitted_rem2 <- lm(c19ProSo02 ~ .,
data = subset(rem, select = -c(coded_country, c19ProSo01, c19ProSo03, c19ProSo04)))
fitted_rem3 <- lm(c19ProSo03 ~ .,
data = subset(rem, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo04)))
fitted_rem4 <- lm(c19ProSo04 ~ .,
data = subset(rem, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo03)))
cat("Summary of models for predicting pro-social attitudes in the rest of the world\n\n")
counter <- 1
for (model in list(fitted_rem1, fitted_rem2, fitted_rem3, fitted_rem4)) {
cat("C19ProSo0", counter, "\n", sep = "")
res <- model_eval(model)
cat("R-squared value:", res[[1]], "\n")
cat("Adjusted R-squared value:", res[[2]], "\n")
cat("Significant predictors with p-value < 0.001:\n")
cat(res[[3]], "\n")
cat("Coefficients of predictors:\n")
cat(res[[4]], "\n")
cat("\n")
for (pred in res[[3]]) {
mdl <- c(mdl, paste0("RoW C19ProSo0", counter))
}
prds <- c(prds, res[[3]])
counter <- counter + 1
}
summ_table <- table(predictors = prds, models = mdl)
# reorder the columns
summ_table <- summ_table[, c("USA C19ProSo01", "USA C19ProSo02", "USA C19ProSo03",
"USA C19ProSo04", "RoW C19ProSo01", "RoW C19ProSo02", "RoW C19ProSo03",
"RoW C19ProSo04")]
summ_table_vis <- ggplot(data = as.data.frame(summ_table)) +
geom_tile(mapping = aes(x = models, y = predictors, fill = Freq, colour = "black")) +
scale_fill_gradientn(colours = c("pink", "green")) +
theme(legend.position = "none") +
scale_x_discrete(position = "top") +
scale_y_discrete(limits = rev) +
labs(x = "Models", y = "Predictors",
title = "Table of significant predictors for each model")
summ_table_vis
collected <- read.csv("task3.csv")
collected_clean <- na.omit(collected)
collected_clean[, 2:9] <- scale(collected_clean[, 2:9])
kfit <- kmeans(collected_clean[, 2:9], round(nrow(collected_clean) / 5), nstart = 15)
clusters <- data.frame(country = collected_clean[[1]], cluster = kfit$cluster)
target <- filter(clusters, country == "United States of America")$cluster
similar <- filter(clusters, cluster == target)
similar
colnames(similar)[colnames(similar) == "country"] <- "coded_country"
intersect <- merge(cvbase, similar, by = "coded_country", all = FALSE)
intersect <- intersect[, -ncol(intersect)]
clus <- filter(intersect, coded_country != "United States of America")
clus_cor <- cor(subset(clus, select = -coded_country), use = "complete.obs")
clus_melted <- reshape2::melt(clus_cor)
clus_cor_plot <- ggplot(data = clus_melted) +
geom_tile(mapping = aes(x = Var1, y = Var2, fill = value)) +
scale_fill_gradient2(low = "#6b74ff", mid = "white", high = "#e46c6c", midpoint = 0) +
labs(title = "Correlation between predictors for countries similar to the United States",
x = "", y = "", fill = "correlation") +
theme(axis.text.x = element_text(angle = 90))
clus_cor_plot
fitted_clus1 <- lm(c19ProSo01 ~ .,
data = subset(clus, select = -c(coded_country, c19ProSo02, c19ProSo03, c19ProSo04)))
fitted_clus2 <- lm(c19ProSo02 ~ .,
data = subset(clus, select = -c(coded_country, c19ProSo01, c19ProSo03, c19ProSo04)))
fitted_clus3 <- lm(c19ProSo03 ~ .,
data = subset(clus, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo04)))
fitted_clus4 <- lm(c19ProSo04 ~ .,
data = subset(clus, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo03)))
cat("Summary of models for predicting pro-social attitudes in countries similar to the US\n\n")
counter <- 1
for (model in list(fitted_clus1, fitted_clus2, fitted_clus3, fitted_clus4)) {
cat("C19ProSo0", counter, "\n", sep = "")
res <- model_eval(model)
cat("R-squared value:", res[[1]], "\n")
cat("Adjusted R-squared value:", res[[2]], "\n")
cat("Significant predictors with p-value < 0.001:\n")
cat(res[[3]], "\n")
cat("Coefficients of predictors:\n")
cat(res[[4]], "\n")
cat("\n")
counter <- counter + 1
}
model_eval_2 <- function(model) {
rsqr <- summary(model)$r.squared
a_rsqr <- summary(model)$adj.r.squared
sig <- which(summary(model)$coefficients[-1, 4] < 0.05) + 1
preds <- rownames(summary(model)$coefficients[sig, , drop = FALSE])
coefs <- summary(model)$coefficients[sig, 1]
return(list(rsqr, a_rsqr, preds, coefs))
}
cat("Summary of models for predicting pro-social attitudes in countries similar to the US\n\n")
counter <- 1
for (model in list(fitted_clus1, fitted_clus2, fitted_clus3, fitted_clus4)) {
cat("C19ProSo0", counter, "\n", sep = "")
res <- model_eval_2(model)
cat("R-squared value:", res[[1]], "\n")
cat("Adjusted R-squared value:", res[[2]], "\n")
cat("Significant predictors with p-value < 0.05:\n")
cat(res[[3]], "\n")
cat("Coefficients of predictors:\n")
cat(res[[4]], "\n")
cat("\n")
for (pred in res[[3]]) {
mdl <- c(mdl, paste0("Similar C19ProSo0", counter))
}
prds <- c(prds, res[[3]])
counter <- counter + 1
}
summ_table_2 <- table(predictors = prds, models = mdl)
summ_table_2 <- summ_table_2[, c("USA C19ProSo01", "USA C19ProSo02", "USA C19ProSo03",
"USA C19ProSo04", "RoW C19ProSo01", "RoW C19ProSo02", "RoW C19ProSo03", "RoW C19ProSo04",
"Similar C19ProSo01", "Similar C19ProSo02", "Similar C19ProSo03", "Similar C19ProSo04")]
summ_table_vis_2 <- ggplot(data = as.data.frame(summ_table_2)) +
geom_tile(mapping = aes(x = models, y = predictors, fill = Freq, colour = "black")) +
scale_fill_gradientn(colours = c("pink", "green")) +
theme(legend.position = "none") +
scale_x_discrete(position = "top") +
scale_y_discrete(limits = rev) +
labs(x = "Pro-social attitudes", y = "Predictors",
title = "Table of significant predictors for each pro-social attitude") +
theme(axis.text.x = element_text(angle = 90))
summ_table_vis_2
head(cvbase)
collected
library(cluster)
clusplot(collected_clean, kfit$cluster, color = TRUE, shade = TRUE, labels = 0, lines = 0)
colnames(similar)[colnames(similar) == "country"] <- "coded_country"
intersect <- merge(cvbase, similar, by = "coded_country", all = FALSE)
intersect <- intersect[, -ncol(intersect)]
clus <- filter(intersect, coded_country != "Croatia")
clus_cor <- cor(subset(clus, select = -coded_country), use = "complete.obs")
clus_melted <- reshape2::melt(clus_cor)
clus_cor_plot <- ggplot(data = clus_melted) +
geom_tile(mapping = aes(x = Var1, y = Var2, fill = value)) +
scale_fill_gradient2(low = "#6b74ff", mid = "white", high = "#e46c6c", midpoint = 0) +
labs(title = "Correlation between predictors for countries similar to Croatia",
x = "", y = "", fill = "correlation") +
theme(axis.text.x = element_text(angle = 90))
clus_cor_plot <- ggplot(data = clus_melted) +
geom_tile(mapping = aes(x = Var1, y = Var2, fill = value)) +
scale_fill_gradient2(low = "#6b74ff", mid = "white", high = "#e46c6c", midpoint = 0) +
labs(title = "Correlation between predictors for countries similar to Croatia",
x = "", y = "", fill = "correlation") +
theme(axis.text.x = element_text(angle = 90))
clus_cor_plot
fitted_clus1 <- lm(c19ProSo01 ~ .,
data = subset(clus, select = -c(coded_country, c19ProSo02, c19ProSo03, c19ProSo04)))
fitted_clus2 <- lm(c19ProSo02 ~ .,
data = subset(clus, select = -c(coded_country, c19ProSo01, c19ProSo03, c19ProSo04)))
fitted_clus3 <- lm(c19ProSo03 ~ .,
data = subset(clus, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo04)))
fitted_clus4 <- lm(c19ProSo04 ~ .,
data = subset(clus, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo03)))
cat("Summary of models for predicting pro-social attitudes in countries similar to the US\n\n")
counter <- 1
for (model in list(fitted_clus1, fitted_clus2, fitted_clus3, fitted_clus4)) {
cat("C19ProSo0", counter, "\n", sep = "")
res <- model_eval(model)
cat("R-squared value:", res[[1]], "\n")
cat("Adjusted R-squared value:", res[[2]], "\n")
cat("Significant predictors with p-value < 0.001:\n")
cat(res[[3]], "\n")
cat("Coefficients of predictors:\n")
cat(res[[4]], "\n")
cat("\n")
counter <- counter + 1
}
model_eval_2 <- function(model) {
rsqr <- summary(model)$r.squared
a_rsqr <- summary(model)$adj.r.squared
sig <- which(summary(model)$coefficients[-1, 4] < 0.05) + 1
preds <- rownames(summary(model)$coefficients[sig, , drop = FALSE])
coefs <- summary(model)$coefficients[sig, 1]
return(list(rsqr, a_rsqr, preds, coefs))
}
cat("Summary of models for predicting pro-social attitudes in countries similar to the US\n\n")
counter <- 1
for (model in list(fitted_clus1, fitted_clus2, fitted_clus3, fitted_clus4)) {
cat("C19ProSo0", counter, "\n", sep = "")
res <- model_eval_2(model)
cat("R-squared value:", res[[1]], "\n")
cat("Adjusted R-squared value:", res[[2]], "\n")
cat("Significant predictors with p-value < 0.05:\n")
cat(res[[3]], "\n")
cat("Coefficients of predictors:\n")
cat(res[[4]], "\n")
cat("\n")
for (pred in res[[3]]) {
each_model <- c(each_model, paste0("Similar C19ProSo0", counter))
}
predictors <- c(predictors, res[[3]])
counter <- counter + 1
}
rm(list = ls())
set.seed(31865224)
cvbase = read.csv("PsyCoronaBaselineExtract.csv")
cvbase <- cvbase[sample(nrow(cvbase), 40000), ]
library(ggplot2)
library(dplyr)
library(tidyr)
dim(cvbase)
as.data.frame(sapply(cvbase, class))
summary(cvbase, na.rm = TRUE)
sort(unique(cvbase$coded_country))
table(cvbase$coded_country)
max(table(cvbase$coded_country))
which(table(cvbase$coded_country) == max(table(cvbase$coded_country)))
min(table(cvbase$coded_country))
which(table(cvbase$coded_country) == min(table(cvbase$coded_country)))
cvbase[is.na(cvbase)] <- 0
croatia <- cvbase[cvbase$coded_country == "Croatia", ]
others <- anti_join(cvbase, croatia)
numeric_cols <- sapply(croatia, is.numeric)
means <- colMeans(croatia[, numeric_cols], na.rm = TRUE)
croatia_means <- data.frame(mean = means)
numeric_cols <- sapply(others, is.numeric)
others_means <- colMeans(others[, numeric_cols], na.rm = TRUE)
others_means <- data.frame(mean = others_means)
croatia_plotted <- ggplot(croatia_means) +
geom_bar(mapping = aes(x = rownames(croatia_means), y = mean), stat = "identity",
fill = "blue") +
coord_flip() +
labs(x = "Survey questions", y = "Mean responses",
title = "Mean of responses for each question in Croatia")
world_plotted <- ggplot(others_means) +
geom_bar(mapping = aes(x = rownames(others_means), y = mean), stat = "identity",
fill = "red") +
coord_flip() +
labs(x = "Survey questions", y = "Mean responses",
title = "Mean of responses for each question over the globe")
croatia_plotted
world_plotted
numeric_croatia <- croatia[sapply(croatia, is.numeric)]
croatia_correlation <- cor(numeric_croatia, use = "complete.obs")
#diag(croatia_cor) <- NA
croatia_melted <- reshape2::melt(croatia_correlation, na.rm = TRUE)
croatia_correlation_plot <- ggplot(data = croatia_melted, aes(x = Var1, y = Var2, fill = value)) +
geom_tile() +
scale_fill_gradient2(low = "#6b74ff", mid = "white", high = "#e46c6c", midpoint = 0) +
labs(title = "Correlation between each of Croatia's predictors", x = "", y = "",
fill = "correlation") +
theme(axis.text.x = element_text(angle = 90))
croatia_correlation_plot
predictors <- NULL
each_model <- NULL
model_evaluated <- function(model) {
rsquared <- summary(model)$r.squared
adjusted_rsquared <- summary(model)$adj.r.squared
sig <- which(summary(model)$coefficients[-1, 4] < 0.001) + 1
predictor <- rownames(summary(model)$coefficients[sig, , drop = FALSE])
coefficient <- summary(model)$coefficients[sig, 1]
return(list(rsquared, adjusted_rsquared, predictor, coefficient))
}
fitted_croatia1 <- lm(c19ProSo01 ~ .,
data = subset(croatia, select = -c(coded_country, c19ProSo02, c19ProSo03, c19ProSo04)))
fitted_croatia2 <- lm(c19ProSo02 ~ .,
data = subset(croatia, select = -c(coded_country, c19ProSo01, c19ProSo03, c19ProSo04)))
fitted_croatia3 <- lm(c19ProSo03 ~ .,
data = subset(croatia, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo04)))
fitted_croatia4 <- lm(c19ProSo04 ~ .,
data = subset(croatia, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo03)))
cat("Pro-social attitudes in Croatia predictors model summary\n\n")
i <- 1
for (model in list(fitted_croatia1, fitted_croatia2, fitted_croatia3, fitted_croatia4)) {
cat("C19ProSo0", i, "\n", sep = "")
collection <- model_evaluated(model)
cat("R-squared:", collection[[1]], "\n")
cat("R-squared Adjusted:", collection[[2]], "\n")
cat("99.999% confidence interval significant predictors:\n")
cat(collection[[3]], "\n")
cat("Coefficients of predictors:\n")
cat(collection[[4]], "\n")
cat("\n")
for (each in collection[[3]]) {
each_model <- c(each_model, paste0("Croatia_C19ProSo0", i))
}
predictors <- c(predictors, collection[[3]])
i <- i + 1
}
others <- anti_join(cvbase, croatia)
numeric_others <- others[sapply(others, is.numeric)]
global_correlation <- cor(numeric_others, use = "complete.obs")
global_melted <- reshape2::melt(global_correlation)
global_correlation_plot <- ggplot(data = global_melted) +
geom_tile(mapping = aes(x = Var1, y = Var2, fill = value)) +
scale_fill_gradient2(low = "#6b74ff", mid = "white", high = "#e46c6c", midpoint = 0) +
labs(title = "Correlation between each of the world's predictors", x = "", y = "",
fill = "correlation") +
theme(axis.text.x = element_text(angle = 90))
global_correlation_plot
fitted_rem1 <- lm(c19ProSo01 ~ .,
data = subset(others, select = -c(coded_country, c19ProSo02, c19ProSo03, c19ProSo04)))
fitted_rem2 <- lm(c19ProSo02 ~ .,
data = subset(others, select = -c(coded_country, c19ProSo01, c19ProSo03, c19ProSo04)))
fitted_rem3 <- lm(c19ProSo03 ~ .,
data = subset(others, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo04)))
fitted_rem4 <- lm(c19ProSo04 ~ .,
data = subset(others, select = -c(coded_country, c19ProSo01, c19ProSo02, c19ProSo03)))
cat("Pro-social attitudes in the world predictors model summary\n\n")
res_counter <- 1
for (model in list(fitted_rem1, fitted_rem2, fitted_rem3, fitted_rem4)) {
cat("C19ProSo0", res_counter, "\n", sep = "")
res <- model_evaluated(model)
cat("R-squared value:", res[[1]], "\n")
cat("Adjusted R-squared value:", res[[2]], "\n")
cat("Significant predictors with p-value < 0.001:\n")
cat(res[[3]], "\n")
cat("Coefficients of predictors:\n")
cat(res[[4]], "\n")
cat("\n")
for (pred in res[[3]]) {
each_model <- c(each_model, paste0("RoW_C19ProSo0", res_counter))
}
predictors <- c(predictors, res[[3]])
res_counter <- res_counter + 1
}
tables_combined <- table(predictors = predictors, models = each_model)
colnames(tables_combined)
#tables_combined <- tables_combined[, c("Croatia_C19ProSo01", "Croatia_C19ProSo02", "Croatia_C19ProSo03",
tables_combined <- tables_combined[, c("Croatia_C19ProSo03",
"Croatia_C19ProSo04", "RoW_C19ProSo01", "RoW_C19ProSo02", "RoW_C19ProSo03",
"RoW_C19ProSo04")]
tables_combined_plotted <- ggplot(data = as.data.frame(tables_combined)) +
geom_tile(mapping = aes(x = models, y = predictors, fill = Freq, colour = "black")) +
scale_fill_gradientn(colours = c("pink", "green")) +
theme(legend.position = "none") +
scale_x_discrete(position = "top") +
scale_y_discrete(limits = rev) +
labs(x = "Models", y = "Predictors",
title = "Significant predictors for individual models")
tables_combined_plotted
collected <- read.csv("task3.csv")
collected_clean <- na.omit(collected)
collected_clean[, 2:9] <- scale(collected_clean[, 2:9])
kfit <- kmeans(collected_clean[, 2:9], round(nrow(collected_clean) / 5), nstart = 15)
clusters <- data.frame(country = collected_clean[[1]], cluster = kfit$cluster)
target <- filter(clusters, country == "Croatia")$cluster
similar <- filter(clusters, cluster == target)
similar
colnames(similar)[colnames(similar) == "country"] <- "coded_country"
intersect <- merge(cvbase, similar, by = "coded_country", all = FALSE)
intersect <- intersect[, -ncol(intersect)]
clus <- filter(intersect, coded_country != "Croatia")
clus_cor <- cor(subset(clus, select = -coded_country), use = "complete.obs")
model_eval_2 <- function(model) {
rsqr <- summary(model)$r.squared
a_rsqr <- summary(model)$adj.r.squared
sig <- which(summary(model)$coefficients[-1, 4] < 0.05) + 1
preds <- rownames(summary(model)$coefficients[sig, , drop = FALSE])
coefs <- summary(model)$coefficients[sig, 1]
return(list(rsqr, a_rsqr, preds, coefs))
}
cat("Summary of models for predicting pro-social attitudes in countries similar to the US\n\n")
counter <- 1
for (model in list(fitted_clus1, fitted_clus2, fitted_clus3, fitted_clus4)) {
cat("C19ProSo0", counter, "\n", sep = "")
res <- model_eval_2(model)
cat("R-squared value:", res[[1]], "\n")
cat("Adjusted R-squared value:", res[[2]], "\n")
cat("Significant predictors with p-value < 0.05:\n")
cat(res[[3]], "\n")
cat("Coefficients of predictors:\n")
cat(res[[4]], "\n")
cat("\n")
for (pred in res[[3]]) {
each <- c(each, paste0("Similar C19ProSo0", counter))
}
predictors <- c(predictors, res[[3]])
counter <- counter + 1
}
model_eval_2 <- function(model) {
rsqr <- summary(model)$r.squared
a_rsqr <- summary(model)$adj.r.squared
sig <- which(summary(model)$coefficients[-1, 4] < 0.05) + 1
preds <- rownames(summary(model)$coefficients[sig, , drop = FALSE])
coefs <- summary(model)$coefficients[sig, 1]
return(list(rsqr, a_rsqr, preds, coefs))
}
cat("Summary of models for predicting pro-social attitudes in countries similar to Croatia\n\n")
counter <- 1
for (model in list(fitted_clus1, fitted_clus2, fitted_clus3, fitted_clus4)) {
cat("C19ProSo0", counter, "\n", sep = "")
res <- model_eval_2(model)
cat("R-squared value:", res[[1]], "\n")
cat("Adjusted R-squared value:", res[[2]], "\n")
cat("Significant predictors with p-value < 0.05:\n")
cat(res[[3]], "\n")
cat("Coefficients of predictors:\n")
cat(res[[4]], "\n")
cat("\n")
for (pred in res[[3]]) {
each_model <- c(each_model, paste0("Similar C19ProSo0", counter))
}
predictors <- c(predictors, res[[3]])
counter <- counter + 1
}
fitted_clus1 <- lm(c19ProSo01 ~ .,
data = subset(clus, select = -c(coded_country, c19ProSo02, c19ProSo03, c19ProSo04)))
